# Курсовой проект "Проектирование корпоративной сети" - Лебедев Д.С.


- [Задание на проектирование](08.CRPNT.DIP.00.md)
- [Результаты тестирования](08.CRPNT.DIP.02.md)

---

- [Файл PKT](_att/0806-dip.pkt)
- [Конфигурация коммутатора доступа (типовая)](_att/conf/0806dip-conf-asw1.txt)
- [Конфигурация коммутатора ядра №1](_att/conf/0806dip-conf-Core_sw1.txt)
- [Конфигурация коммутатора ядра №2](_att/conf/0806dip-conf-Core_sw2.txt)
- [Конфигурация маршрутизатора NAT1](_att/conf/0806dip-conf-nat1.txt)
- [Конфигурация маршрутизатора NAT2](_att/conf/0806dip-conf-nat2.txt)
- [Конфигурация маршрутизатора NAT21](_att/conf/0806dip-conf-nat21.txt)

---
## Пояснительная записка
В соответствии с заданием спроектирована отказоустойчивая сеть, связывающая центральный офис компании и удаленный производственный объект. Предусмотрены решения для обеспечения базовой безопасности и изоляции сетей.

### Структура сети
Исходя из будущих потребностей, требуемое количество портов доступа составляет 200 - 220 штук. Поэтому количество коммутаторов доступа в реальной схеме будет увеличено соответственно данному условию.

Сегментация настроена для обеспечения безопасности за счет изоляции отделов, улучшения управляемости сети и повышения производительности за счет ограничения широковещательных доменов. С учетом текущего количества устройств, структуры сети и планов дальнейшего развития предприятия решено для внутренних сетей центрального офиса и филиала использовать маску /24.

**Центральный офис**
- VLAN 10 - Производственный отдел (192.168.10.0/24)
- VLAN 11 - Отдел продаж (192.168.11.0/24)
- VLAN 12 - ИТ отдел (192.168.12.0/24)
- VLAN 13 - Бухгалтерия и секретариат (192.168.13.0/24)
- VLAN 100 - Периферийные устройства (192.168.100.0/24)
- VLAN 101 - Гостевой Wi-Fi (192.168.101.0/24)

**Производство**
- VLAN 20 - Производственный отдел (192.168.20.0/24)
- VLAN 21 - Резерв (192.168.21.0/24)

#### Адресный план и настройка шлюзов

| Наименование                       | VLAN | NAME   | Маска min | Маска max | Адрес подсети    | Шлюз              | Вирт IP (HSRP) | HSRP группа |
| ---------------------------------- | ---- | ------ | --------- | --------- | ---------------- | ----------------- | -------------- | ----------- |
| Производственный отдел (45+45)     | 10   | PROIZV | 26        | 25        | 192.168.10.0/24  | 192.168.10.2 (3)  | 192.168.10.1   | 10          |
| Отдел продаж (15+15)               | 11   | PROD   | 27        | 26        | 192.168.11.0/24  | 192.168.11.2 (3)  | 192.168.11.1   | 11          |
| ИТ отдел (5+5)                     | 12   | IT     | 29        | 28        | 192.168.12.0/24  | 192.168.12.2 (3)  | 192.168.12.1   | 12          |
| Бухгалтерия (5+5)                  | 13   | BUH    | 29        | 28        | 192.168.13.0/24  | 192.168.13.2 (3)  | 192.168.13.1   | 13          |
| Периферия (10+)                    | 100  | PRINT  | 28        | 24        | 192.168.100.0/24 | 192.168.100.2 (3) | 192.168.100.1  | 100         |
| Беспроводной доступ                | 101  | WLAN   | 24        | 24        | 192.168.101.0/24 | 192.168.101.2 (3) | 192.168.101.1  | 101         |
| Филиал, производств. отдел (10+10) | 20   | FPRO   | 28        | 27        | 192.168.20.0/24  | 192.168.20.2 (3)  | 192.168.20.1   | -           |
| Филиал, резерв                     | 21   | FREZ   | -         | 24        | 192.168.21.0/24  | 192.168.21.2 (3)  | 192.168.21.1   | -           |

| ASW доступ   | CSW Ядро        |
| ------------ | --------------- |
| ASW1 (gi0/1) | CSW1 (gi0/1/11) |
| ASW1 (gi0/2) | CSW2 (gi0/1/11) |
| ASW2 (gi0/1) | CSW1 (gi0/1/12) |
| ASW2 (gi0/2) | CSW2 (gi0/1/12) |
| ASW3 (gi0/1) | CSW1 (gi0/1/13) |
| ASW3 (gi0/2) | CSW2 (gi0/1/13) |

| CSW Ядро (LACP) |               |
| --------------- | ------------- |
| CSW1 gi1/0/23   | CSW2 gi1/0/23 |
| CSW1 gi1/0/24   | CSW2 gi1/0/24 |

#### Интерфейсы, адресация стыковочных сетей и туннелей GRE

| CSW Ядро                   | NAT                              | ISP                     | GRE          |
| -------------------------- | -------------------------------- | ----------------------- | ------------ |
| CSW1 (gi1/0/1) 10.1.1.2/30 | NAT1 (gi0/1) 10.1.1.1/30         |                         |              |
| CSW1 (gi1/1/1) 10.1.2.2/30 | NAT2 (gi0/3/0) 10.1.2.1/30       |                         |              |
|                            |                                  |                         |              |
| CSW2 (gi1/0/1) 10.2.1.2/30 | NAT2 (gi0/1) 10.2.1.1/30         |                         |              |
| CSW2 (gi1/1/1) 10.2.2.2/30 | NAT1 (gi0/3/0) 10.2.2.1/30       |                         |              |
|                            |                                  |                         |              |
|                            | NAT1 (gi0/0) 1.0.0.2/30          | ISP1 (gi0/0) 1.0.0.1/30 |              |
|                            | NAT2 (gi0/0) 1.0.1.2/30          | ISP2 (gi0/0) 1.0.1.1/30 |              |
|                            | NAT21 (gi0/0) 1.0.2.2/30         | ISP3 (gi0/0) 1.0.2.1/30 |              |
|                            | NAT21 (gi0/1.20) 192.168.20.1/24 |                         |              |
|                            | NAT21 (gi0/1.21) 192.168.21.1/24 |                         |              |
|                            |                                  |                         |              |
|                            | NAT1 (tu1)                       |                         | 100.0.0.1/30 |
|                            | NAT2 (tu2)                       |                         | 100.0.1.1/30 |
|                            | NAT21 (tu3)                      |                         | 100.0.0.2/30 |
|                            | NAT21 (tu4)                      |                         | 100.0.1.2/30 |

### Настройка инфраструктуры

- В качестве коммутаторов ядра используются два L3 коммутатора Cisco 3650.
- Для агрегирования каналов между коммутаторами ядра используется протокол LASP.
- Количество коммутаторов доступа определяется исходя из текущих и будущих потребностей.
- Для внутренней динамической маршрутизации используется протокол EIGRP.
- Настроен HSRP на коммутаторах ядра для всех VLAN для обеспечения отказоустойчивости шлюзов.

**Безопасность на уровне L2**

- Включен BPDU Guard и Root Guard для защиты STP.
- Настроен Port Security на портах доступа.
- Используется Rapid PVST+ для быстрой сходимости протокола STP.

**Связь между офисом и производством**

- Между маршрутизаторами созданы GRE туннели для организации связи.
- Домен маршрутизации EIGRP расширен на производство (филиал) для обмена маршрутами.

**NAT и доступ в интернет**

- В центральном офисе NAT Overload настроен на основном маршрутизаторе через ISP1.
- При отказе ISP1 или маршрутизатора NAT1, происходит перестроение маршрутов (через ISP2).
- На производстве (филиал) настроен NAT для локального выхода в интернет через ISP3.

**Настройка ACL**

Для выполнения условий межсетевых взаимодействий:
- Доступ между отделами заблокирован.
- Все отделы (включая филиал) имеют доступ к VLAN с периферийными устройствами.
- Доступ в интернет разрешен для всех пользователей, кроме периферийных устройств.
- Гостевой Wi-Fi имеет доступ только в интернет, не имеет доступа к внутренним сетям.

**Ограничение полосы пропускания**

В соответствии с заданием на интерфейсе бордера NAT2 в сторону ISP2 настроено ограничение исходящей полосы до 10 Мбит/с с помощью политик QoS.

**[Результаты тестирования](08.CRPNT.DIP.02.md)**


---
**Доработка 2024-11-14**

> 1. Ограничение полосы с использованием шейпинга на м в данном случае не подходит на резервном операторе. ...Как можно просто настройкой порта ограничить на этом стыке полосу до 10 Мбит\с?

NAT2
```sh
interface GigabitEthernet0/0
 speed 10
```

> 2. HSRP у вас не сходится на L3-свичах. Обратите внимание на ACL и вспомните как работает HSRP.

CSW1, CSW2
```sh
ip access-list extended...
permit udp any any eq 1985
```

> 3. Можно в процессе EIGRP все сети не объявлять, а просто перераспределить коннектед сети на L3 коммутаторах- так конфиг сократим.

CSW1, CSW2
```sh
router eigrp 100
redistribute connected
```

> 4. bandwidth в сторону резервного бордера я бы и на стороне l3 свичей назначил.

```sh
CSW1(config)#interface GigabitEthernet1/1/1
CSW1(config-if)#bandwidth 10000

CSW2(config)#interface GigabitEthernet1/0/1
CSW2(config-if)#bandwidth 10000
```

*Так и делал, с двух сторон. Но сохраняются эти настройки только в текущем сеансе CPT. Если открыть-закрыть проект, эта настройка исчезает.*